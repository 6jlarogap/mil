{% extends "admin/change_form.html" %}

{% block extrahead %}{{ block.super }}
<script type="text/javascript">
    $ = django.jQuery;

    function updateCatsCounts() {
        var ef = $('#burial_categories-group .empty-form');
        ef.find('td:eq(1)').css('text-align', 'right').html('<p>Итого:</p>');

        var sum1 = 0, sum2 = 0;
        $('#burial_categories-group tr td:eq(2)').each(function() {
            sum1 += parseInt($(this).text());
        });
        $('#burial_categories-group tr td:eq(3) input').each(function() {
            sum2 += parseInt($(this).val());
        });
        ef.find('td:eq(2)').html('<p>'+sum1+'</p>')
        ef.find('td:eq(3)').html('<p>'+sum2+'</p>')
        ef.removeClass('empty-form');
    }

    django.jQuery(function($) {
        $('.form-row.burial_type').before($('#locationburial-group'));
        $('#locationburial-group textarea').css('width', '300px');
        $('#locationburial-group').css({margin: '0', border: 'none'});
        $('#burial_categories-group :input').change(updateCatsCounts);
        updateCatsCounts();
    })
</script>
{% endblock %}